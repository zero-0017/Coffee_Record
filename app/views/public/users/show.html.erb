<div class="container">
  <h4><strong>マイページ</strong></h4>
    <div class="row no-gutters">
      <div class="col-md-5 mx-sm-auto text-center shadow-lg py-5">
        <!--会員名-->
        <h3><%= @user.name %></h3>

        <!--会員画像-->
        <%= image_tag @user.get_profile_image(100,100) %>

          <!--編集ボタン-->
          <% if @user.name != "guestuser" %>
            <% if @user == current_user %><br>
              <%= link_to "プロフィール編集", edit_user_path(@user) %>
            <% end %>
          <% end %>

          <!--いいねした投稿一覧-->
          <%= link_to "いいねした投稿", favorites_user_path(@user) %>
      </div>
    </div>
</div>

<!--会員の投稿一覧-->
<div class="container">
  <h4><strong>投稿一覧</strong></h4>
    <div class="row no-gutters">
      <div class="col-md-5 mx-sm-auto text-center shadow-lg py-5">

        <!--公開・非公開の投稿を選択-->
        <div class="wrapper">
          <ul class="tab">
            <li><a href="#a">公開</a></li>
            <li><a href="#b">非公開</a></li>
          </ul>

            <!--公開の投稿内容-->
            <div id="a" class="area">
              <h2>公開</h2>
                <ul>
                  <% @post_coffees.each do |post_coffee| %>
                    <% if post_coffee.status == "公開" %>

                      <!--投稿画像-->
                      <%= link_to post_coffee_path(post_coffee.id) do %>
                        <%= image_tag post_coffee.get_image, class: "card-img" %>
                      <% end %>

                      <!--会員画像-->
                      <%= image_tag post_coffee.user.get_profile_image(100,100), class: "mt-3" %>

                      <!--投稿名-->
                      <%= post_coffee.coffee_name %>

                      <!--投稿説明-->
                      <%= post_coffee.coffee_explanation %>

                      <!--タグ-->
　                    <%= post_coffee.tag.tag_name %>

　                    <!--コメント数-->
                      <div class="comment_count">
                        コメント数：<%= post_coffee.coffee_comments.count %>
                      </div>

                      <!--いいね機能　[非同期通信化]-->
                      <div class="favorite_buttons_<%= post_coffee.id %>">
                        <%= render "public/favorites/favorite", post_coffee: post_coffee %>
                      </div>
　                  <% end %>
　                 <% end %>
                  </ul>
              </div>

              <!--非公開の投稿内容-->
              <div id="b" class="area">
                <h2>非公開</h2>
                  <ul>
                    <% @post_coffees.each do |post_coffee| %>
                      <% if post_coffee.status == "非公開" %>

                      <!--投稿画像-->
                      <%= link_to post_coffee_path(post_coffee.id) do %>
                        <%= image_tag post_coffee.get_image, class: "card-img" %>
                      <% end %>

                      <!--会員画像-->
                      <%= image_tag post_coffee.user.get_profile_image(100,100), class: "mt-3" %>

                      <!--投稿名-->
                      <%= post_coffee.coffee_name %>

                      <!--投稿説明-->
                      <%= post_coffee.coffee_explanation %>

                      <!--タグ-->
　                    <%= post_coffee.tag.tag_name %>

　                    <!--コメント数-->
                      <div class="comment_count">
                        コメント数：<%= post_coffee.coffee_comments.count %>
                      </div>

                      <!--いいね機能　[非同期通信化]-->
                      <div class="favorite_buttons_<%= post_coffee.id %>">
                        <%= render "public/favorites/favorite", post_coffee: post_coffee %>
                      </div>
　                  <% end %>
　                 <% end %>
                  </ul>
              </div>

      </div>
    </div>
</div>

<script>
//投稿の公開と非公開の設定
document.addEventListener("turbolinks:load", function() {
  function GethashID (hashIDName){
    if(hashIDName){
      $('.tab li').find('a').each(function() {//全ての投稿の公開と非公開を取得
        var idName = $(this).attr('href');
        if(idName == hashIDName){
          var parentElm = $(this).parent();
          $('.tab li').removeClass("active");
          $(parentElm).addClass("active");
          $(".area").removeClass("is-active");
          $(hashIDName).addClass("is-active");
        }
      });
    }
  }

// タブをクリックしたら
  $('.tab a').on('click', function() {
    var idName = $(this).attr('href');//タブ内の投稿を取得
    GethashID (idName);//指定のタグを読み込む
    return false;//aタグを無効
  });

// 読み込まれたら
  $(window).on('load', function () {
      $('.area:first-of-type').addClass("is-active");
    var hashName = location.hash;//指定されたhashタグを取得する
    GethashID (hashName);//指定のタブを読み込む
  });
})
</script>